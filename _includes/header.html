<header style="display:flex; justify-content: space-between; align-items:center; padding:1rem; background-color: var(--header-bg); border-bottom:1px solid var(--border);">
  <h1 id="header-title" style="margin:0;">
    <a href="#" style="color: var(--text); text-decoration:none;">{{ site.title }}</a>
  </h1>

  <nav style="display:flex; gap:1rem; align-items:center;">
    <a href="#" id="nav-home">Home</a>
    <a href="#" id="nav-projects">Projects</a>
    <button id="theme-toggle" style="padding:0.3rem 0.6rem; cursor:pointer;">Toggle Dark Mode</button>
  </nav>
</header>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // --- Dark Mode ---
  const toggleButton = document.getElementById('theme-toggle');
  const storedTheme = localStorage.getItem('theme');
  if (storedTheme) {
    document.documentElement.setAttribute('data-theme', storedTheme);
  } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.setAttribute('data-theme', 'dark');
  }

  toggleButton.onclick = () => {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  };

  // --- Section Navigation with Smooth Fade ---
  const homeLink = document.getElementById('nav-home');
  const projectsLink = document.getElementById('nav-projects');
  const homeSection = document.getElementById('home-section');
  const projectsSection = document.getElementById('projects-section');
  const headerTitle = document.getElementById('header-title');

  const fadeIn = (element) => element.classList.remove('hidden');
  const fadeOut = (element) => element.classList.add('hidden');

  const changeHeaderTitle = (newTitle) => {
    fadeOut(headerTitle);
    setTimeout(() => {
      headerTitle.textContent = newTitle;
      fadeIn(headerTitle);
    }, 250);
  };

  const switchSection = (showSection, hideSection) => {
    fadeOut(hideSection);
    setTimeout(() => {
      fadeIn(showSection);
    }, 250); // matches half of CSS fade duration
  };

  homeLink.onclick = (e) => {
    e.preventDefault();
    switchSection(homeSection, projectsSection);
    changeHeaderTitle('{{ site.title }}');
  };

  projectsLink.onclick = (e) => {
    e.preventDefault();
    switchSection(projectsSection, homeSection);
    changeHeaderTitle('Projects');
  };
});
</script>
